#include <iostream>
#include <vector>
#include <algorithm>
#include <cmath>
#include <fstream>
#include <sstream>
#include <random>
#include <chrono>

using namespace std;

// Helper class implementation
// ... (same as provided in the Affirmative side's argument)

// Solver class implementation
// ... (same as provided in the Affirmative side's argument)

int main() {
    Solver solver;
    try {
        solver.solve();
    } catch (exception& e) {
        e.what();
    }
    return 0;
}
// End of Code
